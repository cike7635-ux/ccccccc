name: ğŸ”„ Update Lockfile

on:
  workflow_dispatch: # æ‰‹åŠ¨è§¦å‘ï¼Œä¸ä¼šè‡ªåŠ¨è¿è¡Œ

jobs:
  update-lockfile:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: ğŸ—ï¸ è®¾ç½® PNPM ç¯å¢ƒ
        uses: pnpm/action-setup@v4

      - name: âš™ï¸ è®¾ç½® Node.js
        uses: actions/setup-node@v4
        with:
          node-version: â€˜20â€™
          cache: â€˜pnpmâ€™

      - name: ğŸ“¦ å®‰è£…ä¾èµ– (è¿™å°†æ›´æ–° pnpm-lock.yaml)
        run: pnpm install

      - name: ğŸ’¾ æäº¤æ›´æ–°åçš„é”æ–‡ä»¶
        run: |
          git config --global user.name â€˜github-actions[bot]â€™
          git config --global user.email â€˜github-actions[bot]@users.noreply.github.comâ€™
          git add pnpm-lock.yaml
          # æ£€æŸ¥æ˜¯å¦æœ‰å˜æ›´ï¼Œæœ‰åˆ™æäº¤
          git diff --staged --quiet || (git commit -m â€˜chore: è‡ªåŠ¨æ›´æ–° pnpm-lock.yamlâ€™ && git push)
